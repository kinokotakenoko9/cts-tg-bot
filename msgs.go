package main

import (
	"context"

	"github.com/go-telegram/bot"
	"github.com/go-telegram/bot/models"
	"github.com/go-telegram/ui/datepicker"
	"github.com/go-telegram/ui/keyboard/inline"
)

func sendMessage(ctx context.Context, b *bot.Bot, update *models.Update, msg string) {
	b.SendMessage(ctx, &bot.SendMessageParams{
		ChatID: update.Message.Chat.ID,
		Text:   msg,
	})
}

func sendResposeIsInvalid(ctx context.Context, b *bot.Bot, update *models.Update) {
	sendMessage(ctx, b, update, "Invalid message")
}

func sendInfo(ctx context.Context, b *bot.Bot, update *models.Update) {
	sendMessage(ctx, b, update, "–í–≤–µ–¥–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É /start, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å.") // TODO: better msg?
}

func sendFormSaved(ctx context.Context, b *bot.Bot, update *models.Update) {
	sendMessage(ctx, b, update, "–í–∞—à –∑–∞–ø—Ä–æ—Å —Å–æ—Ö—Ä–∞–Ω—ë–Ω! üöÜ–Ø —É–≤–µ–¥–æ–º–ª—é –≤–∞—Å, –∫–∞–∫ —Ç–æ–ª—å–∫–æ –ø–æ—è–≤—è—Ç—Å—è –±–∏–ª–µ—Ç—ã, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –≤–∞—à–∏–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º.\n\n–î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å–ø–∏—Å–∫–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã—Ö –±–∏–ª–µ—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ /list.")
}

func sendNoForms(ctx context.Context, b *bot.Bot, update *models.Update) {
	sendMessage(ctx, b, update, "–ù–µ—Ç —Ñ–æ—Ä–º. –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ —Ñ–æ—Ä–º—É —á–µ—Ä–µ–∑ /start.") // TODO: better msg
}

func sendButtonList(ctx context.Context, b *bot.Bot, update *models.Update, names []string, text string, onSelect inline.OnSelect) {
	citiesInlineKeyboard := inline.New(b, inline.NoDeleteAfterClick()) // TODO: bug here, remove inactive keyboards

	for _, name := range names {
		citiesInlineKeyboard.Row().Button(name, []byte(name), onSelect)
	}

	b.SendMessage(ctx, &bot.SendMessageParams{
		ChatID:      update.Message.Chat.ID,
		Text:        text,
		ReplyMarkup: citiesInlineKeyboard,
	})
}

func sendDatePicker(ctx context.Context, b *bot.Bot, update *models.Update, text string, onSelect datepicker.OnSelectHandler) {
	kb := datepicker.New(b, onSelect)

	b.SendMessage(ctx, &bot.SendMessageParams{
		ChatID:      update.Message.Chat.ID,
		Text:        text,
		ReplyMarkup: kb,
	})
}
